<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€æ¹–æ°´ç¶ çš„è–èª•æ¼«æ­¥ã€‘å¥§æ· 10 æ—¥ Vibe</title>
    <!-- å¼•å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Fonts - Inter & Noto Sans TC -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Noto+Sans+TC:wght@300;400;700&display=swap">
    <style>
        :root {
            /* Christmas Vibe Colors */
            --color-primary: #15433C; /* Deep Green */
            --color-accent: #A62F39; /* Wine Red */
            --color-light: #F7F5F0; /* Cream White */
            --color-gold: #D4AF37; /* Gold Accent */
        }
        body {
            font-family: 'Noto Sans TC', 'Inter', sans-serif;
            background-color: var(--color-light);
            color: var(--color-primary);
        }
        .header-bg {
            background-color: var(--color-primary);
        }
        .tab-active {
            color: var(--color-light);
            background-color: var(--color-accent);
            border-bottom: 2px solid var(--color-gold);
        }
        .tab-inactive {
            color: var(--color-light);
            background-color: var(--color-primary);
            opacity: 0.8;
        }
        .card-bg {
            background-color: #ffffff;
            border-left: 5px solid var(--color-accent);
        }
        .vibe-title {
            color: var(--color-accent);
            font-weight: 700;
        }
        .llm-simulated {
            color: var(--color-gold);
            font-weight: 700;
            background-color: rgba(212, 175, 55, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="header-bg p-4 shadow-lg sticky top-0 z-10">
        <h1 class="text-2xl font-bold text-white text-center">ã€æ¹–æ°´ç¶ çš„è–èª•æ¼«æ­¥ã€‘å¥§æ· 10 æ—¥ Vibe</h1>
        <p class="text-sm text-green-200 text-center">åœ˜è™Ÿ: PRG10EKA251208B (2025/12/08 å‡ºç™¼)</p>
    </header>

    <!-- é ‚éƒ¨å°èˆª Tab Bar -->
    <nav class="sticky top-16 z-10 flex text-xs md:text-sm shadow-md">
        <!-- Tab 1: ç¸½è¦½ -->
        <button data-tab="overview" class="tab-button flex-1 py-3 px-1 text-center font-semibold tab-active transition duration-300">ç¸½è¦½ & é ˜éšŠ</button>
        <!-- Tab 2: èˆªç­/ç•¶åœ° -->
        <button data-tab="local" class="tab-button flex-1 py-3 px-1 text-center font-semibold tab-inactive transition duration-300">èˆªç­ & ç•¶åœ°</button>
        <!-- Tab 3: è¡Œç¨‹ -->
        <button data-tab="itinerary" class="tab-button flex-1 py-3 px-1 text-center font-semibold tab-inactive transition duration-300">è¡Œç¨‹ & ç¾é£Ÿ</button>
        <!-- Tab 4: é€€ç¨… -->
        <button data-tab="tax" class="tab-button flex-1 py-3 px-1 text-center font-semibold tab-inactive transition duration-300">é€€ç¨… & è³¼ç‰©</button>
    </nav>

    <main class="p-4 pt-6 max-w-4xl mx-auto">
        <!-- 1. ç¸½è¦½ & é ˜éšŠè³‡è¨Š (Overview Tab) -->
        <section id="overview" class="tab-content space-y-6">
            <h2 class="vibe-title text-xl mb-4">âœ¨ è–èª•ä¹‹æ—…å•Ÿç¨‹</h2>

            <!-- åœ˜å‹™ç¸½è¦½ -->
            <div class="card-bg p-4 rounded-lg shadow-md">
                <h3 class="font-bold text-lg mb-2">åœ˜å‹™ç¸½è¦½</h3>
                <ul class="text-sm space-y-2">
                    <li><span class="font-medium text-red-700">åœ˜ åï¼š</span>é›™äº«å¥§æ· 10 å¤© EK é›™é»é€²å‡º</li>
                    <li><span class="font-medium text-red-700">é›†åˆæ—¥æœŸï¼š</span>2025 å¹´ 12 æœˆ 08 æ—¥ (ä¸€)</li>
                    <li><span class="font-medium text-red-700">é›†åˆæ™‚é–“ï¼š</span>**æ™šä¸Š 21 é» 20 åˆ†**</li>
                    <li><span class="font-medium text-red-700">é›†åˆåœ°é»ï¼š</span>æ¡ƒåœ’åœ‹éš›æ©Ÿå ´ ç¬¬äºŒèˆªå»ˆ é˜¿è¯é…‹èˆªç©º **åœ˜é«”æ«ƒæª¯ (23 è™Ÿæ«ƒæª¯)**</li>
                </ul>
            </div>

            <!-- é ˜éšŠè³‡è¨Š -->
            <div class="card-bg p-4 rounded-lg shadow-md">
                <h3 class="font-bold text-lg mb-2">å°ˆå±¬é ˜éšŠ</h3>
                <p class="text-sm">é ˜ éšŠï¼šæœ±é å…‰ å…ˆç”Ÿ</p>
                <p class="text-sm">æ‰‹æ©Ÿè™Ÿç¢¼ï¼š<a href="tel:0933909186" class="text-blue-600 hover:text-blue-800 font-mono">0933-909-186</a></p>
                <p class="mt-2 text-xs text-gray-500">å¦‚æœ‰ç·Šæ€¥äº‹å‹™ï¼Œè«‹å„ªå…ˆè¯ç¹«é ˜éšŠã€‚</p>
            </div>
        </section>

        <!-- 2. èˆªç­/ç•¶åœ°é ˆçŸ¥ (Local Tab) -->
        <section id="local" class="tab-content hidden space-y-6">
            <h2 class="vibe-title text-xl mb-4">âœˆï¸ èˆªç­/è¡Œæ & ç•¶åœ°é ˆçŸ¥</h2>

            <!-- èˆªç­è³‡è¨Šå¡ (å·²ç§»é™¤äº‚ç¢¼ç¬¦è™Ÿ) -->
            <div class="card-bg p-4 rounded-lg shadow-md space-y-3">
                <h3 class="font-bold text-lg">é˜¿è¯é…‹èˆªç©º EK èˆªç­è³‡è¨Š</h3>
                <div class="border-b pb-2">
                    <p class="font-medium text-red-700">å»ç¨‹ï¼šå°åŒ—åˆ°æœæ‹œè½‰å¸ƒæ‹‰æ ¼ (TPE åˆ° DXB è½‰ PRG)</p>
                    <p class="text-xs ml-2">TPE/DXB EK387 (2025/12/09) 00:20/06:15</p>
                    <p class="text-xs ml-2">DXB/PRG EK139 (2025/12/09) 08:40/12:30</p>
                </div>
                <div>
                    <p class="font-medium text-red-700">å›ç¨‹ï¼šç¶­ä¹Ÿç´åˆ°æœæ‹œè½‰å°åŒ— (VIE åˆ° DXB è½‰ TPE)</p>
                    <p class="text-xs ml-2">VIE/DXB EK126 (2025/12/16) 21:45/06:25+1</p>
                    <p class="text-xs ml-2">DXB/TPE EK386 (2025/12/17) 08:45/20:40</p>
                </div>
                <div class="pt-2 border-t text-sm">
                    <p><span class="font-medium">æ©Ÿå‹åƒè€ƒï¼š</span>å¤šç‚º Boeing 777 æˆ– Airbus A380ã€‚</p>
                    <p><span class="font-medium">è¡Œæé™é¡ï¼š</span>æ‰‹æ 7kg $\mid$ æ‰˜é‹ **30kg** (è«‹æ³¨æ„ä¸è¶…é‡)ã€‚</p>
                </div>
            </div>

            <!-- ç•¶åœ°é ˆçŸ¥/å‹•æ…‹è³‡è¨Š -->
            <div class="card-bg p-4 rounded-lg shadow-md space-y-3">
                <h3 class="font-bold text-lg">ç•¶åœ°è³‡è¨Š (å‹•æ…‹æ›´æ–°)</h3>
                <div id="dynamic-info" class="text-sm space-y-2">
                    <!-- Dynamic Data loaded here -->
                    <p>ç•¶åœ°æ°£æº« (12æœˆ)ï¼šå¸ƒæ‹‰æ ¼/ç¶­ä¹Ÿç´å¹³å‡ <span class="llm-simulated">2Â°C ~ -2Â°C (ä¼°)</span></p>
                    <p>æ™‚å·®ï¼šæ¯”å°ç£æ…¢ <span class="llm-simulated">7 å°æ™‚</span> (å†¬ä»¤)</p>
                    <p>æ·å…‹å…‹æœ— (CZK) åƒè€ƒåŒ¯ç‡ï¼š1 CZK $\approx$ NT$ <span class="llm-simulated" id="rate-czk">è¼‰å…¥ä¸­...</span></p>
                    <p>æ­å…ƒ (EUR) åƒè€ƒåŒ¯ç‡ï¼š1 EUR $\approx$ NT$ <span class="llm-simulated" id="rate-eur">è¼‰å…¥ä¸­...</span></p>
                </div>
                <button onclick="fetchDynamicData()" class="mt-4 w-full py-2 bg-green-800 text-white rounded-md hover:bg-green-700 transition duration-300">
                    é»æ“Šæ›´æ–°å³æ™‚åŒ¯ç‡èˆ‡å¤©æ°£ (æ¨¡æ“¬)
                </button>
            </div>

            <!-- ç¶œåˆæé†’å¡ -->
            <div class="card-bg p-4 rounded-lg shadow-md space-y-3">
                <h3 class="font-bold text-lg">ç¶œåˆæé†’èˆ‡æœƒè©±</h3>
                <ul class="text-sm space-y-2 list-disc list-inside">
                    <li>**èª¿æ™‚å·®å»ºè­°ï¼š** æŠµé”ç•¶æ—¥ç™½å¤©ä¿æŒæ¸…é†’ï¼Œæ™šä¸Šç›¡æ—©ä¼‘æ¯ã€‚</li>
                    <li>**é£²ç”¨æ°´ï¼š** æ·å…‹æ°´ä¸å»ºè­°é£²ç”¨ï¼Œè«‹è³¼è²·ç“¶è£æ°´ã€‚</li>
                    <li>**ä¸Šè»Šè¦å®šï¼š** ä¸èƒ½å¸¶æ¯è£é£²æ–™ã€å†°æ·‡æ·‹ä¸Šè»Šã€‚</li>
                    <li>**æ·å…‹æœƒè©±ï¼š** ä½ å¥½ $\rightarrow$ **DobrÃ½ den** (å¤šå¸ƒé‡Œå…¸) / è¬è¬ $\rightarrow$ **DÄ›kuji** (ç¢Ÿåº«ä¼Š)</li>
                    <li>**å¥§åœ°åˆ©æœƒè©±ï¼š** ä½ å¥½ $\rightarrow$ **Guten Tag** (é¡§é¨° å¡”æ ¼) / è¬è¬ $\rightarrow$ **Danke** (ä¸¹å…‹)</li>
                </ul>
            </div>
        </section>

        <!-- 3. è¡Œç¨‹ & ç¾é£Ÿæ¢ç´¢ (Itinerary Tab) -->
        <section id="itinerary" class="tab-content hidden space-y-6">
            <h2 class="vibe-title text-xl mb-4">ğŸ—ºï¸ è–èª•æ¼«æ­¥ï¼šè¡Œç¨‹ & ç¾é£Ÿæ¢ç´¢</h2>
            <div id="itinerary-list" class="space-y-4">
                <!-- Itinerary Cards will be dynamically inserted here -->
            </div>
        </section>

        <!-- 4. é€€ç¨…è¦å®š (Tax Tab) -->
        <section id="tax" class="tab-content hidden space-y-6">
            <h2 class="vibe-title text-xl mb-4">ğŸ’° é€€ç¨… & æœæ‹œè½‰æ©Ÿç‰¹è¼¯</h2>

            <!-- é€€ç¨…è¦å®šå¡ -->
            <div class="card-bg p-4 rounded-lg shadow-md">
                <h3 class="font-bold text-lg mb-3 border-b pb-2 text-red-700">æ­ç›Ÿé€€ç¨…è¦ç¯„ (æ›´ç°¡æ½”æ˜“æ‡‚ç‰ˆ)</h3>

                <p class="text-sm font-semibold mb-2">ğŸ”– æ·å…‹/å¥§åœ°åˆ© é€€ç¨…é–€æª»ï¼š</p>
                <div class="flex justify-around text-center text-sm mb-4 bg-stone-100 p-2 rounded">
                    <div>
                        <p class="font-bold">æ·å…‹ (CZK)</p>
                        <p class="text-red-700 font-bold">æ»¿ 2,001 CZK</p>
                    </div>
                    <div>
                        <p class="font-bold">å¥§åœ°åˆ© (EUR)</p>
                        <p class="text-red-700 font-bold">æ»¿ 75 EUR</p>
                    </div>
                </div>

                <p class="text-sm font-semibold mb-1">âœ… é€€ç¨…ä¸‰æ­¥é©Ÿï¼š</p>
                <ol class="text-xs space-y-2 list-decimal list-inside ml-2">
                    <li>**è³¼ç‰©æ™‚ï¼š** é”é–€æª»ï¼Œä¸»å‹•å‡ºç¤ºè­·ç…§ï¼Œç´¢å– **é€€ç¨…å–® + æ”¶æ“š + ä¿¡å°**ã€‚</li>
                    <li>**å¡«å¯«è³‡æ–™ï¼š** å¡«å¦¥è‹±æ–‡å§“åã€è­·ç…§è™Ÿç¢¼ã€åŠåœ°å€ï¼š<br><span class="font-mono text-green-800 italic">No. 26, Ln. 347, Sec. 2, Yanping Rd., Xiangshan Dist., Hsinchu City 300057 , Taiwan</span></li>
                    <li>**é›¢å¢ƒæ™‚ (ç¶­ä¹Ÿç´ VIE)ï¼š** å¸¶**æœªæ‹†å°**å•†å“ã€ç¨…å–®ã€æ”¶æ“šï¼Œçµ¦æµ·é—œ**è“‹ç« **å¾Œï¼Œå†é ˜å–é€€ç¨…é‡‘ (ç¾é‡‘æˆ–ä¿¡ç”¨å¡)ã€‚</li>
                </ol>
                <p class="text-xs text-gray-500 mt-3">**ç¨…é‡‘ä½”æ¯”ï¼š** æ·å…‹ VAT ç´„ 21% / å¥§åœ°åˆ© VAT ç´„ 20%ã€‚å¯¦éš›é€€å›é‡‘é¡éœ€æ‰£é™¤é€€ç¨…å…¬å¸æ‰‹çºŒè²»ã€‚</p>
            </div>

            <!-- æœæ‹œè½‰æ©Ÿå¡ -->
            <div class="card-bg p-4 rounded-lg shadow-md">
                <h3 class="font-bold text-lg mb-3 border-b pb-2 text-red-700">ğŸ‡¦ğŸ‡ª æœæ‹œè½‰æ©Ÿç‰¹è¼¯ (DXB)</h3>
                <p class="text-sm mb-3">è½‰æ©Ÿæ™‚é–“å……è£•ï¼Œå¯é€›æœæ‹œå…ç¨…åº— (Dubai Duty Free)ã€‚</p>

                <div class="space-y-3">
                    <p class="font-semibold text-sm">è¿ªæ‹‰å§† (AED) åƒè€ƒåŒ¯ç‡ï¼š1 AED $\approx$ NT$ <span class="llm-simulated" id="rate-aed">è¼‰å…¥ä¸­...</span></p>

                    <p class="font-semibold text-sm">ğŸ å»ºè­°ä¼´æ‰‹ç¦®ï¼š</p>
                    <ul class="text-xs space-y-2 list-disc list-inside ml-2">
                        <li>**é§±é§ç‰›å¥¶å·§å…‹åŠ›** (Camel Milk Chocolate)ï¼šå£æ„Ÿçµ²æ»‘ï¼Œç¨å…·ç‰¹è‰²ã€‚</li>
                        <li>**æ¤°æ£—** (Dates)ï¼šå¸¸æœ‰å …æœå…§é¤¡ï¼Œç•¶åœ°ç‰¹è‰²ç”œé»ã€‚</li>
                        <li>**é¦™æ°´ç²¾æ²¹** (Attar / Perfume Oil)ï¼šä¸­æ±å‚³çµ±é¦™æ°›ï¼Œç„¡é…’ç²¾ã€‚</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 5. ä½å®¿è³‡è¨Š (Separated from local for cleaner view) -->
        <section id="accommodation" class="space-y-6">
            <h2 class="vibe-title text-xl mb-4">ğŸ¨ ä½å®¿è³‡è¨Š</h2>
            <div id="hotel-list" class="space-y-4">
                <!-- Hotel Cards will be dynamically inserted here -->
            </div>
        </section>

    </main>

    <script type="module">
        // æ¨¡æ“¬ Firebase Global Variables for Canvas environment.
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};

        // === éœæ…‹æ•¸æ“šå®šç¾© (ä½¿ç”¨ä¸­æ–‡ï¼Œä¿æŒVibe Codingçš„ä¸€è‡´æ€§) ===

        const tripData = {
            leader: { name: "æœ±é å…‰ å…ˆç”Ÿ", phone: "0933-909-186" },
            dates: { start: "2025/12/08", end: "2025/12/17" },
            englishAddress: "No. 26, Ln. 347, Sec. 2, Yanping Rd., Xiangshan Dist., Hsinchu City 300057 , Taiwan (R.O.C.)"
        };

        // ä¿®æ­£ Google Map é€£çµç‚ºå¯é çš„æœå°‹é€£çµ
        const hotelList = [
            { date: "12/09 - 12/11", city: "å¸ƒæ‹‰æ ¼ (æ·å…‹)", name: "Hotel Duo (4â˜…)", add: "Teplicka 492, Prague, 19000, Czech Republic", tel: "+420-266131111", mapLink: "https://www.google.com/maps/search/?api=1&query=Hotel+Duo+Prague" },
            { date: "12/12", city: "å¸ƒé”å„ªç¶­æœ­ (æ·å…‹)", name: "Clarion Congress Hotel Ceske Budejovice (4â˜…)", add: "Prazska trida 14, Ceske Budejovice, 370 04, Czech Republic", tel: "+420-389102111", mapLink: "https://www.google.com/maps/search/?api=1&query=Clarion+Congress+Hotel+Ceske+Budejovice" },
            { date: "12/13", city: "è–©çˆ¾èŒ²å ¡ (å¥§åœ°åˆ©)", name: "Mercure Salzburg City (4â˜…)", add: "Bayerhamerstrasse 14 a, Salzburg, 5020, Austria", tel: "+43-6628814380", mapLink: "https://www.google.com/maps/search/?api=1&query=Mercure+Salzburg+City" },
            { date: "12/14 - 12/15", city: "ç¶­ä¹Ÿç´ (å¥§åœ°åˆ©)", name: "Hotel Rainers 21 (4â˜…)", add: "Liebermannstrasse/Campus21, Brunn am Gebirge, Vienna, 2345, Austria", tel: "+43-160580540", mapLink: "https://www.google.com/maps/search/?api=1&query=Hotel+Rainers+21+Vienna" },
            { date: "12/16", city: "é£›æ©Ÿä¸Š", name: "IN FLIGHT", add: "VIE/DXB EK126", tel: "-", mapLink: "" },
        ];

        const itinerary = [
            { date: "12/09 (äºŒ)", theme: "ã€åˆè¦‹å¸ƒæ‹‰æ ¼ã€‘é«˜å ¡å€ï¼†æ–°åŸå€æ•£æ­¥", lunch: "æ©Ÿä¸Šè¼•é£Ÿ/è‡ªç†", dinner: "ä¸­å¼å…­èœä¸€æ¹¯+æ°´æœ", details: "ã€ä¸‹è»Šåƒè§€ã€‘é«˜å ¡å€ã€æ–°åŸå€ï¼šè·³èˆçš„æˆ¿å­ã€‚èª¿æ™‚å·®å»ºè­°ï¼šæŠµé”ç•¶æ—¥ç™½å¤©æ´»å‹•æ™‚ä¿æŒæ¸…é†’ã€‚", tips: "é«˜å ¡å€æ˜¯ä¿¯ç°å¸ƒæ‹‰æ ¼çš„å¥½åœ°é»ã€‚" },
            { date: "12/10 (ä¸‰)", theme: "ã€æ³¢è¥¿ç±³äºå¿ƒè‡Ÿã€‘åŸå ¡å€ã€èˆŠåŸå€", lunch: "ç±³å…¶æ—æ¨è–¦é¤", lunchDetail: "MlÃ½nec (æŸ¥ç†å¤§æ©‹æ—æ™¯è§€é¤å»³ï¼Œå»ºè­°æå‰é ç´„): ç´„ 1000 - 1500 CZK", dinner: "ä¸­å¼å…­èœä¸€æ¹¯+æ°´æœ", details: "ã€é–€ç¥¨å®‰æ’ã€‘èˆŠçš‡å®®ã€è–ç¶­ç‰¹æ•™å ‚ã€é»ƒé‡‘å°å··ã€‚ã€ä¸‹è»Šåƒè§€ã€‘æŸ¥ç†å£«æ©‹ã€å¤©æ–‡é˜ã€èˆŠåŸå»£å ´ã€‚ã€é–€ç¥¨å®‰æ’ã€‘å¸ƒæ‹‰æ ¼ä¸€æ—¥åœ°éµç¥¨ã€‚", tips: "è–ç¶­ç‰¹æ•™å ‚æ¥µç‚ºå£¯è§€ï¼Œé»ƒé‡‘å°å··å……æ»¿ç«¥è©±æ°›åœã€‚å…¨æ—¥æ­¥è¡Œé‡å¤§ï¼Œè«‹ç©¿è‘—èˆ’é©ã€‚" },
            { date: "12/11 (å››)", theme: "ã€é‡‘è‰²åŸå¸‚æµªæ¼«ã€‘çŒ¶å¤ªå€ã€ä¼çˆ¾å¡”ç“¦æ²³éŠèˆ¹ã€åŠæ—¥è‡ªç”±æ´»å‹•", lunch: "ä¼çˆ¾å¡”ç“¦æ²³éŠèˆ¹è‡ªåŠ©é¤", dinner: "æ–¹ä¾¿é€›è¡—ï¼Œæ•¬è«‹è‡ªç†", dinnerDetail: "æ¨è–¦ï¼šDeer Restaurent (è€åŸå€æ°£æ°›ä½³ï¼Œè¿‘çŒ¶å¤ªå€): ç´„ 400 - 800 CZKã€‚æˆ–åœ¨èˆŠåŸå»£å ´è–èª•å¸‚é›†äº«ç”¨å°åƒã€‚", details: "ã€ä¸‹è»Šåƒè§€ã€‘ç«è—¥å¡”ã€å¸‚æ°‘æœƒé¤¨ã€çŒ¶å¤ªå€ã€‚éŠèˆ¹æ˜¯æ¬£è³å¸ƒæ‹‰æ ¼å¤©éš›ç·šçš„æœ€ä½³æ–¹å¼ã€‚ã€å»ºè­°è‡ªè²»æ´»å‹•ã€‘å¸ƒæ‹‰æ ¼é»‘å…‰åŠ‡ï¼šæ¯äºº 40 æ­å…ƒ (æœ€ä½æˆè¡Œäººæ•¸ 10 äºº)ã€‚", tips: "è«‹å‹™å¿…åƒåŠ é»‘å…‰åŠ‡ï¼Œæ˜¯æ·å…‹ç‰¹è‰²è—è¡“è¡¨æ¼”ã€‚" },
            { date: "12/12 (äº”)", theme: "ã€ç«¥è©±å°é®ã€‘çš®çˆ¾æ£®ï¼åº«å€«æ´›å¤«ï¼å¸ƒé”å„ªç¶­æœ­", lunch: "çš®çˆ¾æ£®çƒ¤é›é¢¨å‘³é¤+å•¤é…’ä¸€æ¯", lunchDetail: "çš®çˆ¾æ£®çƒ¤é›ï¼ˆPeÄenÃ© kuÅ™eï¼‰æ­é…çš®çˆ¾æ£®å•¤é…’ï¼ˆPilsner Urquellï¼‰ã€‚", dinner: "ç™¾å¹´åœ°çª–è±¬è…³é¢¨å‘³é¤", dinnerDetail: "KrÄma Å atlava (CK å°é®åœ°çª–é¤å»³): çƒ¤è±¬è…³ï¼ˆKolenoï¼‰ç´„ 300 - 500 CZKã€‚", details: "ã€ä¸‹è»Šåƒè§€ã€‘çš®çˆ¾æ£®ä¸»æ•™åº§å ‚ã€åº«å€«æ´›å¤«åŸå ¡å€ã€èˆŠåŸå€ã€‚è¨»ï¼šåº«å€«æ´›å¤«çŸ³æ¿è·¯å¤šï¼Œå»ºè­°æ”œå¸¶éå¤œåŒ…ã€‚", tips: "åº«å€«æ´›å¤«æ˜¯ä¸–ç•Œæ–‡åŒ–éºç”¢ï¼Œè¨˜å¾—åœ¨åŸå ¡ä¿¯ç°å°é®å…¨æ™¯ã€‚" },
            { date: "12/13 (å…­)", theme: "ã€æ¹–å…‰å±±è‰²ã€‘å¾·åœ‹åœ‹ç‹æ¹–ã€å¥§åœ°åˆ©è–©çˆ¾èŒ²å ¡", lunch: "æ–¹ä¾¿é€›è¡—ï¼Œæ•¬è«‹è‡ªç†", lunchDetail: "æ¨è–¦ï¼šè–©çˆ¾èŒ²å ¡æ ¼æ‹‰ç‰¹å¤§è¡— (Getreidegasse) å‘¨é‚Šå°åƒ/å’–å•¡å»³ï¼Œå˜—è©¦ç•¶åœ°ç”œé» Salzburger Nockerlã€‚", dinner: "ä¸­å¼å…­èœä¸€æ¹¯+æ°´æœ", details: "ã€ä¸‹è»Šåƒè§€ã€‘åœ‹ç‹æ¹–ã€ç±³æ‹‰è²çˆ¾èŠ±åœ’ã€è«æœ­ç‰¹æ•…å±…ã€‚ã€å»ºè­°è‡ªè²»æ´»å‹•ã€‘åœ‹ç‹æ¹–éŠèˆ¹ / è²å¸Œç‰¹æ–¯åŠ ç™»é¹½ç¤¦æ´ï¼šå„ 40 æ­å…ƒã€‚", tips: "åœ‹ç‹æ¹–æ˜¯å¾·åœ‹æœ€ä¹¾æ·¨çš„æ¹–ï¼Œé¢¨æ™¯å¦‚ç•«ï¼Œå»ºè­°è‡ªè²»éŠèˆ¹æ‰èƒ½æ·±å…¥æ¹–å€ã€‚" },
            { date: "12/14 (æ—¥)", theme: "ã€æœ€ç¾å°é®ã€‘å“ˆæ–¯é”ç‰¹ (Hallstatt)ã€å‰å¾€ç¶­ä¹Ÿç´", lunch: "æ¹–å€é±’é­šé¢¨å‘³é¤", lunchDetail: "çƒ¤é±’é­šï¼ˆForelleï¼‰æ˜¯æ¹–å€ç‰¹è‰²ç¾é£Ÿï¼Œè‚‰è³ªç´°å«©ã€‚", dinner: "æ–¹ä¾¿é€›è¡—ï¼Œæ•¬è«‹è‡ªç†", dinnerDetail: "ç¶­ä¹Ÿç´å¸‚å€æˆ–é£¯åº—é™„è¿‘è¼•é£Ÿã€‚è‹¥æ”¹è–å‰çˆ¾æ ¹ï¼Œå¯åƒè€ƒæ¹–é‚Šé¤å»³ BrÃ¤ugasthof Lobisserã€‚", details: "ã€ä¸‹è»Šåƒè§€ã€‘å“ˆæ–¯é”ç‰¹ (è‹¥é¡æ»¿å‰‡æ”¹åƒè§€è–å‰çˆ¾æ ¹)ã€‚è¨»ï¼šè‹¥é‡ç¶­ä¹Ÿç´å¤§å±•ï¼Œé£¯åº—å¯èƒ½æ”¹ä½å¸ƒæ‹‰ææ–¯æ‹‰ç“¦åŒç´šé£¯åº—ã€‚", tips: "å“ˆæ–¯é”ç‰¹é¢¨æ™¯ç¨ç‰¹ï¼Œè¨˜å¾—å¤šæ‹å¹¾å¼µæ˜ä¿¡ç‰‡è§’åº¦çš„ç…§ç‰‡ã€‚" },
            { date: "12/15 (ä¸€)", theme: "ã€å¸åœ‹çš„é¤˜æš‰ã€‘ç†Šå¸ƒæœ—å®®å¾ŒèŠ±åœ’ã€éœå¤«å ¡ã€æ½˜æœµèŠ™è³¼ç‰©æ‘", lunch: "ç¶­ä¹Ÿç´ç‚¸è±¬æ’é¢¨å‘³é¤", lunchDetail: "ç¶­ä¹Ÿç´ç‚¸è±¬æ’ï¼ˆWiener Schnitzelï¼‰æ˜¯å¥§åœ°åˆ©åœ‹èœï¼Œå¤–çš®é…¥è„†ã€‚", dinner: "æ–¹ä¾¿é€›è¡—ï¼Œæ•¬è«‹è‡ªç†", dinnerDetail: "æ¨è–¦ï¼šFiglmÃ¼ller (ç™¾å¹´ç‚¸è±¬æ’è€åº—) æˆ–å¸‚æ”¿å»³è–èª•å¸‚é›†å°åƒ: ç´„ 18 - 25 EURã€‚", details: "ã€ä¸‹è»Šåƒè§€ã€‘éœå¤«å ¡ã€ç†Šå¸ƒæœ—å®®å¾ŒèŠ±åœ’ã€æ½˜æœµèŠ™è³¼ç‰©æ‘ã€‚ã€å»ºè­°è‡ªè²»æ´»å‹•ã€‘ç†Šå¸ƒæœ—å®®ï¼šæ¯äºº 45 æ­å…ƒã€‚", tips: "è³¼ç‰©æ‘æ˜¯æ¡è²·çš„å¥½æ™‚æ©Ÿï¼Œæ³¨æ„ç‡Ÿæ¥­æ™‚é–“ã€‚åˆ¥å¿˜äº†åƒåŠ ç¶­ä¹Ÿç´éŸ³æ¨‚æœƒï¼" },
            { date: "12/16 (äºŒ)", theme: "ã€è—è¡“èˆ‡éŸ³æ¨‚ã€‘è²ç¶­å¸çˆ¾å®®ã€èˆŠåŸå€ã€å•Ÿç¨‹", lunch: "ç¶­ä¹Ÿç´è±¬è‚‹æ’é¢¨å‘³é¤", lunchDetail: "ç¶­ä¹Ÿç´è±¬è‚‹æ’ï¼ˆSpareribsï¼‰ä»½é‡é©šäººï¼Œæ¨è–¦ Ribs of Viennaã€‚", dinner: "æ–¹ä¾¿é€€ç¨…ï¼Œæ•¬è«‹è‡ªç†", dinnerDetail: "åœ¨æ©Ÿå ´æˆ–å¸‚å€è¼•é£Ÿï¼Œç¢ºä¿æœ‰è¶³å¤ æ™‚é–“è¾¦ç†é€€ç¨…æ‰‹çºŒã€‚", details: "ã€ä¸‹è»Šåƒè§€ã€‘è²ç¶­å¸çˆ¾å®®ã€ç™¾æ°´å…¬å¯“ã€è–å²å¸èŠ¬å¤§æ•™å ‚ã€‚è¨»ï¼šä¸‹åˆç´„ 17:00 å·¦å³å‰å¾€æ©Ÿå ´è¾¦ç†é€€ç¨…èˆ‡å ±åˆ°ã€‚", tips: "è²ç¶­å¸çˆ¾å®®æ”¶è—äº†å…‹æ—å§†çš„ã€Šå»ã€‹ï¼Œå€¼å¾—ä¸€çœ‹ã€‚" }
        ];

        const marketTips = [
            { city: "å¸ƒæ‹‰æ ¼", name_cn: "ç…™å›ªæ²", name_local: "TrdelnÃ­k", price: "120 - 180 CZK", feature: "å¤–é…¥å…§è»Ÿçš„è‚‰æ¡‚ç³–çƒ¤éºµåŒ…ï¼Œé¦™æ°£é€¼äººã€‚", image: "https://placehold.co/150x100/A62F39/F7F5F0?text=TrdelnÃ­k" },
            { city: "å¸ƒæ‹‰æ ¼", name_cn: "ç†±ç´…é…’", name_local: "SvaÅ™enÃ© vÃ­no", price: "80 - 150 CZK", feature: "åŠ å…¥è‚‰æ¡‚ã€ä¸é¦™çš„æº«æš–ç´…é…’ï¼Œé©…æ•£å¯’æ„ã€‚", image: "https://placehold.co/150x100/15433C/F7F5F0?text=SvaÅ™enÃ©+vÃ­no" },
            { city: "ç¶­ä¹Ÿç´", name_cn: "ç‚¸é¦¬éˆ´è–¯é¤…", name_local: "Kartoffelpuffer", price: "5 - 8 EUR", feature: "é‡‘é»ƒé…¥è„†çš„é¦¬éˆ´è–¯ç…é¤…ï¼Œæ­é…é…¸å¥¶æˆ–è˜‹æœé†¬ã€‚", image: "https://placehold.co/150x100/D4AF37/15433C?text=Kartoffelpuffer" },
            { city: "ç¶­ä¹Ÿç´", name_cn: "çƒ¤é¦™è…¸", name_local: "Bratwurst", price: "4 - 6 EUR", feature: "å¤šæ±çš„ç‚­ç«çƒ¤é¦™è…¸ï¼Œå¤¾éºµåŒ…äº«ç”¨ã€‚", image: "https://placehold.co/150x100/A62F39/F7F5F0?text=Bratwurst" }
        ];

        // === å‡½å¼åº« ===

        /**
         * æ¨¡æ“¬ LLM API å‘¼å«ï¼Œå–å¾—å‹•æ…‹åŒ¯ç‡èˆ‡å¤©æ°£è³‡è¨Š
         */
        async function fetchDynamicData() {
            const apiKey = ""; // Canvas will automatically provide the key if this is empty
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const prompt = `
                è«‹æä¾›ä»¥ä¸‹æ•¸æ“šçš„æœ€æ–°ä¼°ç®—å€¼ï¼Œä¸¦ä»¥ JSON æ ¼å¼å›å‚³ï¼Œæ•¸å­—ä¿ç•™å°æ•¸é»å¾Œä¸€ä½ï¼Œä¸è¦åŒ…å«ä»»ä½•é¡å¤–èªªæ˜æˆ– Markdown æ ¼å¼ã€‚
                1. æ·å…‹å…‹æœ— (CZK) å…Œæ–°å°å¹£ (NTD) çš„åŒ¯ç‡ (1 CZK $\approx$ NTD)ã€‚
                2. æ­å…ƒ (EUR) å…Œæ–°å°å¹£ (NTD) çš„åŒ¯ç‡ (1 EUR $\approx$ NTD)ã€‚
                3. é˜¿è¯é…‹è¿ªæ‹‰å§† (AED) å…Œæ–°å°å¹£ (NTD) çš„åŒ¯ç‡ (1 AED $\approx$ NTD)ã€‚
                4. 2025å¹´12æœˆå¸ƒæ‹‰æ ¼ (Prague) çš„é è¨ˆå¹³å‡æ°£æº«ç¯„åœ (Celsius)ã€‚
            `;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                tools: [{ "google_search": {} }],
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "czk_ntd_rate": { "type": "STRING", "description": "1 CZK $\approx$ NTD value" },
                            "eur_ntd_rate": { "type": "STRING", "description": "1 EUR $\approx$ NTD value" },
                            "aed_ntd_rate": { "type": "STRING", "description": "1 AED $\approx$ NTD value" },
                            "prague_dec_temp": { "type": "STRING", "description": "Prague December average temperature range in Celsius" }
                        }
                    }
                }
            };

            const maxRetries = 3;
            let delay = 1000;

            document.getElementById('rate-czk').textContent = 'æ›´æ–°ä¸­...';
            document.getElementById('rate-eur').textContent = 'æ›´æ–°ä¸­...';
            document.getElementById('rate-aed').textContent = 'æ›´æ–°ä¸­...';

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (jsonText) {
                        const parsedData = JSON.parse(jsonText);
                        
                        // Update UI with simplified text
                        document.getElementById('rate-czk').textContent = (parseFloat(parsedData.czk_ntd_rate) || 1.4).toFixed(1) + ' NTD';
                        document.getElementById('rate-eur').textContent = (parseFloat(parsedData.eur_ntd_rate) || 35.0).toFixed(1) + ' NTD';
                        document.getElementById('rate-aed').textContent = (parseFloat(parsedData.aed_ntd_rate) || 8.8).toFixed(1) + ' NTD';

                        const tempElement = document.getElementById('dynamic-info').querySelector('.llm-simulated');
                        if (tempElement) {
                            tempElement.textContent = parsedData.prague_dec_temp || '2Â°C ~ -2Â°C (ä¼°)';
                        }
                        console.log("Dynamic data updated successfully.");
                        return; // Success, exit loop
                    }

                } catch (error) {
                    console.error("API call failed (retry needed):", error.message);
                    if (i < maxRetries - 1) {
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2; // Exponential backoff
                    } else {
                        // Final fallback to static/default data
                        document.getElementById('rate-czk').textContent = '1.4 NTD (ä¼°)';
                        document.getElementById('rate-eur').textContent = '35.0 NTD (ä¼°)';
                        document.getElementById('rate-aed').textContent = '8.8 NTD (ä¼°)';
                    }
                }
            }
        }


        /**
         * æ¸²æŸ“ä½å®¿è³‡è¨Šå¡ç‰‡
         */
        function renderHotels() {
            const container = document.getElementById('hotel-list');
            container.innerHTML = hotelList.map(hotel => `
                <div class="card-bg p-4 rounded-lg shadow-lg">
                    <div class="flex items-center justify-between mb-2">
                        <p class="text-xs font-semibold text-gray-500">${hotel.date}</p>
                        <span class="px-2 py-1 bg-green-200 text-green-800 text-xs rounded-full">${hotel.city}</span>
                    </div>
                    <h3 class="font-bold text-lg text-red-700">${hotel.name}</h3>
                    <p class="text-xs text-gray-600 truncate mb-2">${hotel.add}</p>
                    <div class="flex justify-between items-center text-sm">
                        <!-- ä½¿ç”¨ Google Maps æœå°‹é€£çµ -->
                        <a href="${hotel.mapLink}" target="_blank" class="flex items-center text-blue-600 hover:text-blue-800 transition duration-300 ${hotel.mapLink ? '' : 'opacity-50 pointer-events-none'}" aria-label="Open Google Map">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0l-4.243-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                            ${hotel.mapLink ? 'Google Map (æœå°‹)' : 'ç„¡åœ°åœ–'}
                        </a>
                        <a href="tel:${hotel.tel}" class="text-gray-700 hover:text-red-700 transition duration-300">
                            TEL: ${hotel.tel}
                        </a>
                    </div>
                </div>
            `).join('');
        }

        /**
         * æ¸²æŸ“è¡Œç¨‹å¡ç‰‡ (åŒ…å«è–èª•å¸‚é›†)
         */
        function renderItinerary() {
            const container = document.getElementById('itinerary-list');
            let html = '';

            // 1. è–èª•å¸‚é›†ç‰¹è¼¯
            html += `
                <div class="bg-red-700 text-white p-4 rounded-lg shadow-lg mb-6">
                    <h3 class="font-black text-xl mb-3 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-yellow-300" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5 2a1 1 0 011 1v1h3V3a1 1 0 112 0v1h3V3a1 1 0 112 0v1h1a1 1 0 011 1v2a1 1 0 01-1 1h-1v7a2 2 0 01-2 2H6a2 2 0 01-2-2V8H3a1 1 0 01-1-1V5a1 1 0 011-1h1V3a1 1 0 011-1zm6 4H9v2h2V6zm-6 4H4v7a1 1 0 001 1h10a1 1 0 001-1v-7h-2v2h-2v-2h-2v2H7v-2z" clip-rule="evenodd"></path></svg>
                        è–èª•å¸‚é›† (Christmas Market) ç‰¹è¼¯
                    </h3>
                    <p class="text-sm italic mb-4 text-red-200">12æœˆå¥§æ·çš„éˆé­‚ï¼å¿…åƒå¿…é«”é©—çš„æº«é¦¨æ»‹å‘³ã€‚</p>
                    <div class="grid grid-cols-2 gap-3 text-sm">
                        ${marketTips.map(tip => `
                            <div class="bg-white p-3 rounded-md text-gray-800 shadow-inner">
                                <p class="font-bold">${tip.name_cn} <span class="text-xs text-gray-500">(${tip.city})</span></p>
                                <p class="text-xs text-red-700">${tip.name_local}</p>
                                <p class="text-xs mt-1">${tip.feature}</p>
                                <p class="text-xs text-green-800 mt-1">ç´„ ${tip.price}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // 2. æ¯æ—¥è¡Œç¨‹
            html += itinerary.map((day, index) => `
                <div class="card-bg p-4 rounded-lg shadow-lg itinerary-card" data-index="${index}">
                    <div class="flex items-center justify-between cursor-pointer">
                        <h3 class="font-bold text-lg flex flex-col sm:flex-row">
                            <span class="text-red-700 mr-2">${day.date}</span>
                            <span class="text-green-800">${day.theme.replace(/ã€|ã€‘/g, '')}</span>
                        </h3>
                        <svg class="w-5 h-5 text-red-700 transition-transform duration-300 arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </div>

                    <div class="itinerary-detail hidden mt-4 border-t pt-4 space-y-3 text-sm">
                        <p><span class="vibe-title">â­ è¡Œç¨‹å…§å®¹ï¼š</span>${day.details}</p>
                        <p><span class="vibe-title">ğŸ½ï¸ åˆé¤ï¼š</span>${day.lunch} <span class="text-gray-500 text-xs">${day.lunchDetail || ''}</span></p>
                        <p><span class="vibe-title">ğŸ· æ™šé¤ï¼š</span>${day.dinner} <span class="text-gray-500 text-xs">${day.dinnerDetail || ''}</span></p>
                        <p><span class="vibe-title">ğŸ’¡ Vibe Tipsï¼š</span>${day.tips}</p>
                    </div>
                </div>
            `).join('');

            container.innerHTML = html;

            // Add event listeners for accordion
            document.querySelectorAll('.itinerary-card').forEach(card => {
                card.addEventListener('click', function() {
                    const detail = this.querySelector('.itinerary-detail');
                    const arrow = this.querySelector('.arrow-icon');
                    detail.classList.toggle('hidden');
                    arrow.classList.toggle('rotate-180');
                });
            });
        }

        /**
         * è™•ç† Tab é é¢åˆ‡æ›
         */
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab-button');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');

                    // Update button styles
                    tabs.forEach(t => {
                        t.classList.remove('tab-active');
                        t.classList.add('tab-inactive');
                    });
                    this.classList.add('tab-active');
                    this.classList.remove('tab-inactive');

                    // Update content visibility
                    contents.forEach(content => {
                        content.classList.add('hidden');
                        if (content.id === targetTab) {
                            content.classList.remove('hidden');
                        }
                    });

                    // Ensure accommodation section is displayed below the active tab
                    const accommodationSection = document.getElementById('accommodation');
                    if (targetTab === 'itinerary' || targetTab === 'local') {
                         accommodationSection.classList.remove('hidden');
                    } else {
                        accommodationSection.classList.add('hidden');
                    }

                    // For tax/dubai, ensure accommodation is hidden
                    if (targetTab === 'tax' || targetTab === 'overview') {
                        accommodationSection.classList.add('hidden');
                    }
                });
            });
            // Initial setting: Only show accommodation with the initial 'overview' tab
            document.getElementById('accommodation').classList.add('hidden');
        }

        // === åˆå§‹åŒ– ===
        window.onload = function() {
            console.log("App Initialized. Current App ID:", appId);
            // è¼‰å…¥å‹•æ…‹æ•¸æ“š
            fetchDynamicData();
            // æ¸²æŸ“åˆ—è¡¨
            renderHotels();
            renderItinerary();
            // è¨­ç½® Tab é é¢
            setupTabs();
        }
    </script>
</body>
</html>


